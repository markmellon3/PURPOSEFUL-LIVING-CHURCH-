<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Media Gallery | Purposeful Living Church</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ================= BASE ================= */
* {margin:0; padding:0; box-sizing:border-box;}
body { font-family: 'Inter', sans-serif; background:#f8f9fa; color:#111; }

/* ================= NAVIGATION ================= */
nav {
  display:flex;
  justify-content:center;
  background:#0b63ff;
  padding:15px 10px;
  gap:25px;
  flex-wrap:wrap;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
nav a {
  color:white;
  text-decoration:none;
  font-weight:600;
  transition:0.3s;
}
nav a:hover {
  color:#ffd700;
  text-shadow:0 2px 6px rgba(0,0,0,0.3);
}

/* ================= HEADER ================= */
header {
  background:#0b63ff;
  color:white;
  text-align:center;
  padding:25px 15px;
  font-size:24px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:1px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}

/* ================= FOOTER ================= */
footer {
  background:#111;
  color:white;
  text-align:center;
  padding:20px;
  margin-top:40px;
  font-size:0.95rem;
}

/* ================= GALLERY ================= */
.gallery {
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:15px;
  padding:25px 20px;
  max-width:1200px;
  margin:0 auto;
}
.gallery img {
  width:100%;
  aspect-ratio:1.5/1;
  object-fit:cover;
  border-radius:12px;
  box-shadow:0 8px 20px rgba(0,0,0,0.12);
  cursor:pointer;
  opacity:0;
  transform:translateY(20px);
  transition:transform 0.5s, opacity 0.5s, box-shadow 0.3s;
}
.gallery img.show {
  opacity:1;
  transform:translateY(0);
}
.gallery img:hover {
  transform:scale(1.05);
  box-shadow:0 12px 28px rgba(0,0,0,0.2);
}

/* ================= PAGINATION ================= */
.pagination {
  display:flex;
  justify-content:center;
  gap:15px;
  margin:25px 0 40px;
}
.pagination button {
  padding:12px 25px;
  background:#0b63ff;
  color:white;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
  transition:0.3s;
}
.pagination button:hover:not(:disabled) {
  background:#0951c4;
  box-shadow:0 6px 15px rgba(11,99,255,0.3);
}
.pagination button:disabled {
  background:#777;
  cursor:not-allowed;
}

/* ================= LIGHTBOX ================= */
#lightbox {
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.8);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  visibility:hidden;
  transition:opacity 0.3s;
  z-index:999;
}
#lightbox img {
  max-width:100%;
  max-height:100%;
  border-radius:12px;
  box-shadow:0 12px 28px rgba(0,0,0,0.4);
}
#lightbox.show {
  opacity:1;
  visibility:visible;
}

/* ================= RESPONSIVE ================= */
@media(max-width:1024px){ .gallery { grid-template-columns:repeat(3,1fr); } }
@media(max-width:768px){ .gallery { grid-template-columns:repeat(3,1fr); } }
@media(max-width:480px){ .gallery { grid-template-columns:repeat(3,1fr); } }
</style>
</head>
<body>

<!-- Navigation -->
<nav>
  <a href="index.html">Home</a>  
  <a href="kids.html">Kids Ministry</a>
  <a href="youth.html">Youth Ministry</a>
  <a href="#">Outreach Ministry</a>
</nav>

<header>PURPOSEFUL LIVING CHURCH — MEDIA GALLERY</header>

<!-- Gallery -->
<div class="gallery" id="gallery"></div>

<!-- Pagination -->
<div class="pagination">
  <button id="prevBtn" onclick="prevPage()">Previous</button>
  <button id="nextBtn" onclick="nextPage()">Next</button>
</div>

<!-- Lightbox -->
<div id="lightbox" onclick="closeLightbox()">
  <img id="lightboxImg" src="" alt="Popup Image">
</div>

<footer>© 2025 Purposeful Living Church — All Rights Reserved</footer>

<script>
let currentPage = 1;
const imagesPerPage = 35;
let allImages = [];
const folderURL = "https://ik.imagekit.io/s95tumxuk/church-gallery/";

// Check if an image exists
function checkImage(url) {
  return new Promise(resolve => {
    const img = new Image();
    img.onload = () => resolve(true);
    img.onerror = () => resolve(false);
    img.src = url;
  });
}

// Automatically discover images
async function discoverImages() {
  const oldLength = allImages.length;
  let index = 1;
  let newImages = [];
  while (true) {
    const url = `${folderURL}image${index}.jpg?updatedAt=${Date.now()}`;
    const exists = await checkImage(url);
    if (!exists) break;
    if (!allImages.find(img => img.url === url)) newImages.push({url});
    index++;
  }
  allImages = allImages.concat(newImages);
  displayPage(currentPage, newImages);
}

// Display images for current page
function displayPage(page, newImages=[]) {
  const gallery = document.getElementById("gallery");
  gallery.innerHTML = "";
  currentPage = page;

  const start = (page - 1) * imagesPerPage;
  const end = start + imagesPerPage;
  const pageImages = allImages.slice(start, end);

  pageImages.forEach((file, i) => {
    const img = document.createElement("img");
    img.src = file.url;
    img.onclick = () => openLightbox(file.url);
    gallery.appendChild(img);
    // Fade-in animation
    setTimeout(() => img.classList.add('show'), i*100);
  });

  const totalPages = Math.ceil(allImages.length / imagesPerPage);
  document.getElementById("prevBtn").disabled = currentPage === 1;
  document.getElementById("nextBtn").disabled = currentPage === totalPages;
}

// Pagination functions
function nextPage() {
  const totalPages = Math.ceil(allImages.length / imagesPerPage);
  if (currentPage < totalPages) displayPage(currentPage + 1);
}
function prevPage() {
  if (currentPage > 1) displayPage(currentPage - 1);
}

// Lightbox functions
function openLightbox(url) {
  const lb = document.getElementById('lightbox');
  const lbImg = document.getElementById('lightboxImg');
  lbImg.src = url;
  lb.classList.add('show');
}
function closeLightbox() {
  const lb = document.getElementById('lightbox');
  lb.classList.remove('show');
}

// Refresh every 60s to detect new images
setInterval(discoverImages, 60000);

// Start automatically
discoverImages();
</script>

</body>
</html>